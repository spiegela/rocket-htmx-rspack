## Project Stack

This project is a boilerplate for a small, fast Rust/[Rocket](https://rocket.rs) + [HTMX](https://htmx.org/) setup with [Rspack](https://rspack.dev/) as the bundler. I have [another example](https://github.com/spiegela/rocket-htmx-cdn) with no bundler. In both projects, I'm using [Franken UI](https://franken-ui.dev/) for framework independent UI components.

## Project Initial Setup

I wrote this really for my own reference, but maybe someone else will find it useful. I want to keep track of all the things that were done to setup the project, so that I remember how to upgrade it or modify it in the future. I did start with a few dependencies that shouldn't be too hard to get ggoing:
* [`nvm`](https://github.com/nvm-sh/nvm)
* [`bun`](https://bun.sh/)

I'm using the latest `node`/`npm` until I see things break. If they break a lot, I'll try backing off to LTS:

```shell
nvm use system
# Now using system version of node: v22.5.1 (npm v10.8.2)
```

Create a new Rspack project:
```shell
bun create rspack@latest
# ✔ Project folder … rocket-htmx-rspack
# ? Project template › - Use arrow-keys. Return to submit.
#     vanilla
# ❯   vanilla-ts
#     react
#     react-ts
#     vue
#     vue-ts
# Done. Now run:
# 
# cd rocket-htmx-rspack
# bun install
# bun run dev
cd rocket-htmx-rspack
```

Now add tailwindcss:

```shell
bun add -D tailwindcss postcss postcss-loader autoprefixer
# bun add v1.1.15 (b23ba1fe)
# warn: incorrect peer dependency "@rspack/core@1.0.0-beta.1"
# 
# + @rspack/cli@1.0.0-beta.1
# + @rspack/core@1.0.0-beta.1
# + cross-env@7.0.3
# + ts-node@10.9.2
# + typescript@5.5.4
# 
# installed tailwindcss@3.4.7 with binaries:
#  - tailwind
#  - tailwindcss
# installed postcss@8.4.40
# installed postcss-loader@8.1.1
# installed autoprefixer@10.4.20 with binaries:
#  - autoprefixer
# 
# 376 packages installed [1.85s]
# 
npx tailwindcss init -p
```

Add the postcss rule the Rspack config as described in the tailwindcss docs:

```javascript
module.exports = {
  // ...
  module: {
    rules: [
        {
            test: /\.css$/,
            use: [
                {
                    loader: 'postcss-loader',
                    options: {
                        postcssOptions: {
                            plugins: {
                                tailwindcss: {},
                                autoprefixer: {},
                            },
                        },
                    },
                },
            ],
            type: "css",
        },

// ...
```

Add the tailwindcss config as described in the tailwindcss docs:

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

Add Franken-UI:

```shell
$ bun add franken-ui
# bun add v1.1.15 (b23ba1fe)
# 
# installed franken-ui@0.1.2 with binaries:
#  - franken-ui
# 
# 5 packages installed [1.72s]
```

Now that the UI is installed, we'll setup the Rust/Rocket server.

First, let's install some Cargo tooling for recompiling the server when the source changes:

And then we'll create a new Rust project:
```shell
cargo init --bin .
Creating binary (application) package
note: see more `Cargo.toml` keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html
```

```diff
# rspack.config.ts
-   plugins: [new rspack.HtmlRspackPlugin({ template: "./index.html" })],
+   plugins: [],
```

And we can remove the `index.html` generated by Bun:
```shell
rm -f index.html
```

The remaining changes are in the Rust code. I didn't commit as I was going, but the basic elements are:
* Create templates in the `templates` directory
* Create a `main.rs` file with the Rocket server setup
* Add a `Rocket.toml` file with the configuration for the server
* Use `rocket_db_pools` for database connections, and setup migrations
* Setup static files and dist folder for serving frontend assets. I make these lower priorities, but still mount on the root path.
* Add all the routes to render the templates.

